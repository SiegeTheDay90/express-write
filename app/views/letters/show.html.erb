<%# app/views/letters/show.html.erb %>
<style>
    pre {white-space: pre-wrap;}
</style>
<% current = @letter || TempLetter.last %>
<% prev = TempLetter.where("created_at < ? OR (created_at = ? AND id < ?)", current.created_at, current.created_at, current.id).order(created_at: :desc, id: :desc).first %>
<% nxt  = TempLetter.where("created_at > ? OR (created_at = ? AND id > ?)", current.created_at, current.created_at, current.id).order(created_at: :asc, id: :asc).first %>

<% if current %>
    <div class="actions">
        <% if prev %>
            <%= link_to "← Previous", url_for(controller: 'letters', action: 'show', id: prev.secure_id), class: "btn" %>
        <% else %>
            <button disabled class="btn">← Previous</button>
        <% end %>

        <% if nxt %>
            <%= link_to "Next →", url_for(controller: 'letters', action: 'show', id: nxt.secure_id), class: "btn" %>
        <% else %>
            <button disabled class="btn">Next →</button>
        <% end %>
    </div>
    <h1>Latest TempLetter (ID: <%= current.secure_id %>)</h1>
    <p><strong>Created:</strong> <%= current.created_at %></p>

    <section class="temp-letter-content" width="100vw" style="border: 1px solid #ccc; padding: 10px; margin-bottom: 20px;">
        <%# show common text fields if present, otherwise dump attributes except timestamps %>
        <% if current.respond_to?(:body) %>
            <pre><%= current.body %></pre>
        <% elsif current.respond_to?(:content) %>
            <pre><%= current.content %></pre>
        <% else %>
            <pre><%= current.attributes.except('created_at', 'updated_at').map { |k,v| "#{k}: #{v}" }.join("\n") %></pre>
        <% end %>
    </section>

    <%# find previous (older) and next (newer) relative to current by created_at then id %>
<% else %>
    <p>No TempLetters found.</p>
<% end %>
